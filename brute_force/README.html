<!DOCTYPE HTML>
<html lang="en-US" manifest="../manifest.appcache">
    <head prefix="og: http://ogp.me/ns# book: http://ogp.me/ns/book#">
        
        <meta charset="UTF-8">
        <title>Brute Force | Defeating DVWA</title>

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="robots" content="index, follow">
        <meta name="author" content="jsrn">
        <meta name="description" content="My trip through the Damn Vulnerable WebApp">
        <meta name="keywords" content="gitbook,github" >
        <meta name="generator" content="www.gitbook.io">

        
        <link rel="next" href="../command_execution/README.html" />
        
        
        <link rel="prev" href="../sql_injection/README.html" />
        

        <meta property="og:title" content="Brute Force | Defeating DVWA">
        <meta property="og:site_name" content="Defeating DVWA">
        <meta property="og:type" content="book">
        <meta property="og:locale" content="en_US">

        <meta property="book:author" content="https://github.com/jsrn">
        <meta property="book:tag" content="GitBook">

        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">

        <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">
        
    </head>
    <body>
        

        <link rel="stylesheet" href="../gitbook/style.css">
        


        
    <div class="book" data-github="jsrn/DefeatingDVWA" data-level="2" data-basepath=".." data-revision="1400493443786">
    <div class="book-header">
    <!-- Actions Left -->
    
    <a href="https://github.com/jsrn/DefeatingDVWA" target="_blank" class="btn pull-left"><i class="fa fa-bookmark-o"></i></a>
    
    <a href="#" class="btn pull-left toggle-summary"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search"><i class="fa fa-search"></i></a>
    <span id="font-settings-wrapper">
        <a href="#" class="btn pull-left toggle-font-settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
	<div class="dropdown-caret">
  <span class="caret-outer"></span>
  <span class="caret-inner"></span>
</div>

	<div class="btn-group btn-block">
		<button id="reduce-font-size" class="btn btn-default">A</button>
		<button id="enlarge-font-size" class="btn btn-default">A</button>
	</div>

	<ul class="list-group font-family-list">
		<li class="list-group-item" data-font="0">Serif</li>
		<li class="list-group-item" data-font="1">Sans</li>
	</ul>

	<div class="btn-group btn-group-xs btn-block color-theme-list">
	  <button type="button" class="btn btn-default" id="color-theme-preview-0" data-theme="0">White</button>
	  <button type="button" class="btn btn-default" id="color-theme-preview-1" data-theme="1">Sepia</button>
	  <button type="button" class="btn btn-default" id="color-theme-preview-2" data-theme="2">Night</button>
	</div>
</div>

    </span>

    <!-- Actions Right -->
    
    <a href="#" target="_blank" class="btn pull-right" data-sharing="google-plus"><i class="fa fa-google-plus"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right" data-sharing="facebook"><i class="fa fa-facebook"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right" data-sharing="twitter"><i class="fa fa-twitter"></i></a>
    

    
    <a href="https://github.com/jsrn/DefeatingDVWA/stargazers" target="_blank" class="btn pull-right count-star hidden-xs"><i class="fa fa-star-o"></i> Star (<span>-</span>)</a>
    <a href="https://github.com/jsrn/DefeatingDVWA/watchers" target="_blank" class="btn pull-right count-watch hidden-xs"><i class="fa fa-eye"></i> Watch (<span>-</span>)</a>
    

    <!-- Title -->
    <h1>
        <i class="fa fa-spinner fa-spin"></i>
        <a href="../" >Defeating DVWA</a>
    </h1>
</div>

    <div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Search" class="form-control" />
    </div>
    <ul class="summary">
        
        <li>
            <a href="https://github.com/jsrn" target="blank">About the author</a>
        </li>
        

        
        <li>
            <a href="https://github.com/jsrn/DefeatingDVWA/issues" target="blank">Questions and Issues</a>
        </li>
        

        
        <li>
            <a href="https://github.com/jsrn/DefeatingDVWA/edit/master/brute_force/README.md" target="blank">Edit and Contribute</a>
        </li>
        

        
        <li class="divider"></li>
        

        <li data-level="0" data-path="index.html">
            <a href="../"><i class="fa fa-check"></i> Introduction</a>
        </li>
        
            <li  data-level="1" data-path="sql_injection/README.html">
                
                <a href="../sql_injection/README.html">
                    <i class="fa fa-check"></i> <b>1.</b> SQL Injection
                </a>
                
                
            </li>
        
            <li  data-level="2" data-path="brute_force/README.html">
                
                <a href="../brute_force/README.html">
                    <i class="fa fa-check"></i> <b>2.</b> Brute Force
                </a>
                
                
            </li>
        
            <li  data-level="3" data-path="command_execution/README.html">
                
                <a href="../command_execution/README.html">
                    <i class="fa fa-check"></i> <b>3.</b> Command Execution
                </a>
                
                
            </li>
        
            <li  data-level="4" data-path="file_inclusion/README.html">
                
                <a href="../file_inclusion/README.html">
                    <i class="fa fa-check"></i> <b>4.</b> File Inclusion
                </a>
                
                
            </li>
        
            <li  data-level="5" data-path="tips_and_tricks/README.html">
                
                <a href="../tips_and_tricks/README.html">
                    <i class="fa fa-check"></i> <b>5.</b> Tips and Tricks
                </a>
                
                
                <ul class="articles">
                    
                        <li  data-level="5.1" data-path="tips_and_tricks/burp_intruder.html">
                            
                            <a href="../tips_and_tricks/burp_intruder.html">
                                <i class="fa fa-check"></i> <b>5.1.</b> Burp Intruder
                            </a>
                            
                        </li>
                    
                        <li  data-level="5.2" data-path="tips_and_tricks/cracking_hashes.html">
                            
                            <a href="../tips_and_tricks/cracking_hashes.html">
                                <i class="fa fa-check"></i> <b>5.2.</b> Cracking Password Hashes
                            </a>
                            
                        </li>
                    
                </ul>
                
            </li>
        

        
        <li class="divider"></li>
        <li>
            <a href="http://www.gitbook.io/" target="blank">Generated using GitBook</a>
        </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="page-wrapper" tabindex="-1">
                <div class="book-progress">
    <div class="bar">
        <div class="inner" style="width: 28.571428571428573%;min-width: 14.285714285714286%;"></div>
    </div>
    <div class="chapters">
    
        <a href="../index.html" title="Introduction" class="chapter done new-chapter" data-progress="0" style="left: 0%;"></a>
    
        <a href="../sql_injection/README.html" title="SQL Injection" class="chapter done new-chapter" data-progress="1" style="left: 14.285714285714286%;"></a>
    
        <a href="../brute_force/README.html" title="Brute Force" class="chapter done new-chapter" data-progress="2" style="left: 28.571428571428573%;"></a>
    
        <a href="../command_execution/README.html" title="Command Execution" class="chapter  new-chapter" data-progress="3" style="left: 42.857142857142854%;"></a>
    
        <a href="../file_inclusion/README.html" title="File Inclusion" class="chapter  new-chapter" data-progress="4" style="left: 57.142857142857146%;"></a>
    
        <a href="../tips_and_tricks/README.html" title="Tips and Tricks" class="chapter  new-chapter" data-progress="5" style="left: 71.42857142857143%;"></a>
    
        <a href="../tips_and_tricks/burp_intruder.html" title="Burp Intruder" class="chapter  " data-progress="5.1" style="left: 85.71428571428571%;"></a>
    
        <a href="../tips_and_tricks/cracking_hashes.html" title="Cracking Password Hashes" class="chapter  " data-progress="5.2" style="left: 100%;"></a>
    
    </div>
</div>

                <div class="page-inner">
                
                    <section class="normal" id="section-gitbook_3">
                    
                        <h1 id="brute-force">Brute Force</h1>
<p>This challenge focuses on brute-forcing a generic username/password log on panel. An initial attempt to log in with random details yields the response:</p>
<pre><code>Username and/or password incorrect.
</code></pre><p>Well alright, that gives us something to work with. Before diving in, take a while to familiarise yourself with <a href="http://portswigger.net/burp/help/intruder.html" target="_blank">Burp Intruder</a>, which is what I used. </p>
<p>For now we&#39;ll keep it simple. Try to log in with the username <code>admin</code> and password <code>admin</code>. We&#39;re not lucky enough for that to be correct, so take a look at the <code>HTTP History</code> subsection of the <code>Proxy</code> tab. You should be able to find the GET request to    <code>/dvwa/vulnerabilities/brute/?username=whatever&amp;password=whatever&amp;Login=Login</code>. Right click on it, and select <code>Send to Intruder</code>.</p>
<p>We&#39;ll keep it simple and attempt to brute force the password for the <code>admin</code> user.</p>
<p>Remove all payload positions except for the <code>password</code> parameter in the GET request. On the payloads tab, under <code>Payload Options</code>, you can import your password list. I have provided one for this web app. You can find it <a href="files/passwords.txt">here</a>.</p>
<p>Now that we&#39;ve loaded our password list into Burp and set the payload position, selecting <code>Intruder -&gt; Start attack</code> on the top menu will open the attack window and begin sending requests.</p>
<p>This is great, but all we have is a bunch of requests. It&#39;s not immediately clear which request, if any, gets us any closer to having access. Under the options, we can add keywords to flag any response containing that response. Since we know an incorrect login attempt will spit out &quot;Username and/or password incorrect.&quot; we can add &quot;incorrect&quot; to the list.</p>
<h2 id="low">Low</h2>
<p>Having done the previous preparation, we can now just relaunch the attack. There is now a column called &quot;incorrect&quot;. As the responses roll in, we see almost every box is ticked. When we get down to &quot;password&quot;, however. There is no tick!</p>
<p>If we try logging in with the combination <code>admin</code>/<code>password</code>, we are greeted with the following:</p>
<pre><code>Welcome to the password protected area admin
</code></pre><p>A look at the page source code also reveals something interesting.</p>
<pre><code class="lang-php"><span class="hljs-variable">$user</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">'username'</span>];

<span class="hljs-variable">$pass</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">'password'</span>];
<span class="hljs-variable">$pass</span> = md5(<span class="hljs-variable">$pass</span>);

<span class="hljs-variable">$qry</span> = <span class="hljs-string">"SELECT * FROM `users` WHERE user='$user' AND password='$pass';"</span>;
</code></pre>
<p>Another case of non-existent input sanitisation.</p>
<p>Attempting to log in with the username <code>admin;#</code> escapes the rest of the query and saves us the effort of having to brute force at all.</p>
<h2 id="medium">Medium</h2>
<pre><code class="lang-php"><span class="hljs-comment">// Sanitise username input</span>
<span class="hljs-variable">$user</span> = <span class="hljs-variable">$_GET</span>[ <span class="hljs-string">'username'</span> ];
<span class="hljs-variable">$user</span> = mysql_real_escape_string( <span class="hljs-variable">$user</span> );

<span class="hljs-comment">// Sanitise password input</span>
<span class="hljs-variable">$pass</span> = <span class="hljs-variable">$_GET</span>[ <span class="hljs-string">'password'</span> ];
<span class="hljs-variable">$pass</span> = mysql_real_escape_string( <span class="hljs-variable">$pass</span> );
<span class="hljs-variable">$pass</span> = md5( <span class="hljs-variable">$pass</span> );
</code></pre>
<p>We&#39;re not so lucky this time! They&#39;ve fixed the SQL injection vulnerability by cleaning their inputs. However, using burpsuite for the brute force is still equally successful.</p>
<h2 id="high">High</h2>
<p>Under high security, DVWA adds an artificial delay of three seconds after each incorrect password. If you&#39;re lucky enough to have a target with a weak password, this still makes brute force more or less infeasible. You can escape this problem by using a tool that allows you to send requests in parallel. Sadly, the free edition of Burp does not.</p>

                    
                    </section>
                
                </div>
            </div>
        </div>

        
        <a href="../sql_injection/README.html" class="navigation navigation-prev "><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../command_execution/README.html" class="navigation navigation-next "><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        

        <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.3/ace.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.3/mode-javascript.js"></script>
        <script src="../gitbook/jsrepl/jsrepl.js" id="jsrepl-script"></script>
        <script src="../gitbook/app.js"></script>
        

    
    <script src="../gitbook/plugins/gitbook-plugin-mixpanel/plugin.js"></script>
    

    
    <script src="http://cdn.mathjax.org/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-mathjax/plugin.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {};
    gitbook.start(config);
});
</script>

    </body>
</html>
